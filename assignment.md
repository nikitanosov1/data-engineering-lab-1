# Задание к лабораторной работе №1

Заданием на лабораторную работу является реализация следующего пайплайна:

```mermaid
flowchart TD
    A["Prefect Deployment (cron)"] --> B{{Старт Flow: weather_etl}}
    B --> C["Параметры: города = {Москва, Самара}"]
    C --> D["Прогноз на завтра"]
    D --> E["Сохранить JSON в MinIO"]
    D --> F["Нормализация почасовых значений"]
    D --> G["Аггрегация дневных данных"]

    F --> I["Загрузка в таблицу weather_hourly"]
    G --> J["Загрузка в таблицу weather_daily"]

    I --> CH[(ClickHouse)]
    J --> CH
    E --> MinIO

    J --> L["Отправка уведомления в Telegram Bot"]
    L --> M[Завершение]

    %% Стили
    classDef store fill:#e3f2fd,stroke:#64b5f6,color:#0d47a1;
    classDef task fill:#fff3e0,stroke:#fb8c00,color:#e65100;
    class S3,CH,CH2 store;
    class D,E,F,G,H,I,J,L task;
```

1. В качестве источника данных предлагается использовать [Free Weather API](open-meteo.com)
2. `(Extract)` Получить прогноз **на завтра** по переменным: *температура, осадки, скорость и направление ветра* для городов **Самара и Москва**. Сырые ответы API сохранить в объектном хранилище
3. `(Transform)`
    - Извлечь почасовые значения и нормализовать для таблицы `weather_hourly`
    - Посчитать дневную статистику (min, max, avg температуру и количество осадков) и подготовить для сохранения в таблице `weather_daily`
4. `(Load)` Загрузить преобразованные данные в соответствующие таблицы ClickHouse
5. Автоматически отправить уведомления в Telegram с кратким прогнозом на завтра и предупреждать о сильном ветре/осадках
6. **(Опционально)** Реализовать обработку различных ошибок.

## Используемые инструменты

1. `Perfect` - для реализации ETL пайплайна.
2. `MinIO` - для объектного хранилища.
3. `Clickhouse` - для базы данных.

## Ожидаемый результат

Что должно быть в репозитории:
1. Код пайплайна с использованием `Prefect`.
2. Фрагменты кода инициализации таблиц в `Clickhouse`.
3. `Docker Compose` файл описывающий окружение используемое для выполнения работы.
4. Отчет в формате `.pdf`.